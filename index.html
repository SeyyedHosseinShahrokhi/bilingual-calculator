<!doctype html>
<!--suppress ALL -->
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title data-i18n="title">ماشین حساب</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="ماشین حساب دوزبانه، سریع و دسترس‌پذیر." data-i18n-attr-content="description">

    <!-- رنگ تم برای مرورگر - این‌ها با جاوااسکریپت بروزرسانی می‌شوند -->
    <meta name="theme-color" id="theme-color-light" media="(prefers-color-scheme: light)" content="#F0F4F8">
    <meta name="theme-color" id="theme-color-dark" media="(prefers-color-scheme: dark)" content="#0b2230">

    <!-- Manifests -->
    <link rel="manifest" href="/assets/manifest.en.webmanifest" type="application/manifest+json">

    <!-- Icons -->
    <link rel="icon" href="/assets/icons/favicon.ico" sizes="any">
    <link rel="icon" href="/assets/icons/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32.png">
    <link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png">

    <link rel="stylesheet" href="/assets/css/fonts.css">
    <link rel="stylesheet" href="/assets/css/variables.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/pwa-popup.css">

    <!-- اسکریپت تم باید در head باشد تا از چشمک زدن (FOUC) جلوگیری کند -->
    <script src="/assets/js/theme.js"></script>
</head>
<body class="calc-container">
<noscript>برای استفاده از ماشین حساب، جاوااسکریپت را فعال کنید.</noscript>

<header class="top-bar">
    <nav aria-label="language switcher" class="lang-switch">
        <button type="button" class="lang-btn" data-lang="fa" aria-pressed="true">
            <!-- پرچم ایران -->
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="16" viewBox="0 0 630 360">
                <rect width="630" height="360" fill="#da0000"/>
                <rect width="630" height="240" fill="#fff"/>
                <rect width="630" height="120" fill="#239f40"/>
                <g transform="translate(8.4,100.4)">
                    <g id="ir-tb4">
                        <g id="ir-tb1" fill="none" stroke="#fff" stroke-width="2">
                            <path id="ir-tbp1" d="M0,1H26M1,10V5H9V9H17V5H12M4,9H6M26,9H21V5H29M29,0V9H37V0M33,0V9" transform="scale(1.4)"/>
                            <path id="ir-tbp2" d="M0,7H9M10,7H19" transform="scale(2.8)"/>
                            <use href="#ir-tbp2" y="120"/>
                            <use href="#ir-tbp1" y="145.2"/>
                        </g>
                        <g id="ir-tb3">
                            <use href="#ir-tb1" x="56"/>
                            <use href="#ir-tb1" x="112"/>
                            <use href="#ir-tb1" x="168"/>
                        </g>
                    </g>
                    <use href="#ir-tb3" x="168"/>
                    <use href="#ir-tb4" x="392"/>
                </g>
                <g fill="#da0000" transform="matrix(45,0,0,45,315,180)">
                    <g id="ir-emblem_half">
                        <path d="M 1.015679,-0.01556 A 0.77528237,0.7752862 0 0 1 0.60199011,0.67052066 1.0040699,1.0040749 0 0 0 0.44435035,-0.74067818 q -0.0221518,-0.0177005 -0.0452767,-0.0341288 A 0.77575926,0.7757631 0 0 1 1.015679,-0.01556 Z"/>
                        <path d="m 0.65590144,-0.04683837 a 0.92689013,0.92689472 0 0 1 -1.21301321,0.88105983 q 0.0245198,0.00118 0.0492749,0.001178 a 1.0158759,1.0158809 0 0 0 0.84183925,-1.58419413 0.92423346,0.92423804 0 0 1 0.32189906,0.7019563 z"/>
                        <path d="M 0.26154437,-0.94393072 A 0.14154065,0.14154135 0 0 1 1.7299476e-6,-0.86887791 L -0.01707249,-0.88602911 1.7299476e-6,-0.96931462 A 0.1321491,0.13214975 0 0 0 0.24983482,-1.0002001 a 0.14021999,0.14022068 0 0 1 0.0117096,0.0562694 z"/>
                        <path d="M 0.11992727,-0.71445117 A 0.31475286,0.31475442 0 0 1 1.2855032e-6,-0.81025163 L -0.0506876,-0.01642556 1.2855032e-6,1.0001998 0.07882572,0.89166862 0.0891995,0.64144186 0.09996594,0.3809197 l 0.0014156,-0.0334002 4.7111e-4,-0.0124172 0.002279,-0.0541474 0.006758,-0.1640148 0.005501,-0.13242286 0.001571,-0.03827263 0.002042,-0.04872535 V -0.71445117 Z M 1.2855032e-6,-0.54965037 9.0174383e-5,-0.54949481 1.2855032e-6,-0.54933925 Z m 0,0.86447753 V 0.3145916 L 3.946188e-4,0.31468049 Z"/>
                    </g>
                    <use href="#ir-emblem_half" transform="scale(-1,1)"/>
                </g>
            </svg>
            <span>فارسی</span>
        </button>
        <button type="button" class="lang-btn" data-lang="en" aria-pressed="false">
            <!-- پرچم بریتانیا -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="28" height="14">
                <clipPath id="uk-s">
                    <path d="M0,0 v30 h60 v-30 z"/>
                </clipPath>
                <clipPath id="uk-t">
                    <path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"/>
                </clipPath>
                <g clip-path="url(#uk-s)">
                    <path d="M0,0 v30 h60 v-30 z" fill="#012169"/>
                    <path d="M0,0 L60,30 M60,0 L0,30" stroke="#fff" stroke-width="6"/>
                    <path d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#uk-t)" stroke="#C8102E" stroke-width="4"/>
                    <path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"/>
                    <path d="M30,0 v30 M0,15 h60" stroke="#C8102E" stroke-width="6"/>
                </g>
            </svg>
            <span>English</span>
        </button>
    </nav>

    <div class="theme-switcher">
        <button type="button" id="theme-toggle" aria-label="تغییر تم" data-i18n-attr-aria-label="toggleTheme">
            <!-- خورشید -->
            <svg class="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <!-- دایره مرکزی خورشید -->
                <circle fill="currentColor" cx="12" cy="12" r="5"/>

                <!-- تعریف یک شعله (پرتو) به عنوان یک الگو در بخش defs -->
                <defs>
                    <line id="sun-ray" x1="12" y1="2" x2="12" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </defs>

                <!-- استفاده از الگو و چرخاندن آن برای ایجاد 8 شعله متقارن -->
                <use href="#sun-ray"/>
                <use href="#sun-ray" transform="rotate(45 12 12)"/>
                <use href="#sun-ray" transform="rotate(90 12 12)"/>
                <use href="#sun-ray" transform="rotate(135 12 12)"/>
                <use href="#sun-ray" transform="rotate(180 12 12)"/>
                <use href="#sun-ray" transform="rotate(225 12 12)"/>
                <use href="#sun-ray" transform="rotate(270 12 12)"/>
                <use href="#sun-ray" transform="rotate(315 12 12)"/>
            </svg>
            <svg class="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M21.64,13.24A9.12,9.12,0,0,1,11.53,2.36,9.12,9.12,0,0,0,2.36,11.53a9.12,9.12,0,1,0,19.28,1.71Z"/></svg>
        </button>
    </div>
</header>

<!-- این بخش برای لودر اضافه شده است -->
<div id="loader" class="loader-container hidden">
    <div class="loader"></div>
</div>

<main class="calculator" role="main" aria-label="ماشین حساب" data-i18n-attr-aria-label="appLabel" dir="ltr">
    <!-- بخش نمایشگر برای اضافه شدن دکمه کپی کمی تغییر کرده است -->
    <section class="display">
        <output id="txt_display" role="status" aria-live="polite" aria-atomic="true" data-i18n-attr-aria-label="displayLabel" dir="ltr"></output>
        <div class="result-container">
            <output id="txt_result" role="status" aria-live="polite" aria-atomic="true" data-i18n-attr-aria-label="resultLabel" dir="ltr">0</output>
            <!-- دکمه کپی نتیجه -->
            <button id="btn-copy" class="item copy-btn" type="button" aria-label="کپی کردن نتیجه" data-i18n-attr-aria-label="copyResult">
                <!-- آیکون کپی (SVG) -->
                <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
            </button>
        </div>
    </section>

    <section class="controls" aria-label="controls" data-i18n-attr-aria-label="controlsLabel">
        <button id="btn-power" class="item circle" type="button" aria-pressed="true" data-i18n-attr-aria-label="power">
            <span class="circle-child calc-on"><span class="circle-child calc-end" data-i18n="on">روشن</span></span>
        </button>
        <button id="btn-clear" class="item calc-eraser" type="button" data-i18n="clear" data-i18n-attr-aria-label="clear" data-key="escape">پاک‌کردن</button>
        <button id="btn-backspace" class="item triangle-left" type="button" data-i18n="backspace" data-i18n-attr-aria-label="backspace" data-key="backspace">حذف</button>
        <button class="item operator" type="button" data-value="/" data-i18n="divide" data-i18n-attr-aria-label="divide" data-key="/">÷</button>
    </section>

    <section class="keypad">
        <button class="item number" type="button" data-value="1" data-key="1">1</button>
        <button class="item number" type="button" data-value="2" data-key="2">2</button>
        <button class="item number" type="button" data-value="3" data-key="3">3</button>
        <button class="item operator" type="button" data-value="*" data-i18n="multiply" data-i18n-attr-aria-label="multiply" data-key="*">×</button>
        <button class="item number" type="button" data-value="4" data-key="4">4</button>
        <button class="item number" type="button" data-value="5" data-key="5">5</button>
        <button class="item number" type="button" data-value="6" data-key="6">6</button>
        <button class="item operator red" type="button" data-value="-" data-i18n="subtract" data-i18n-attr-aria-label="subtract" data-key="-">−</button>
        <button class="item number" type="button" data-value="7" data-key="7">7</button>
        <button class="item number" type="button" data-value="8" data-key="8">8</button>
        <button class="item number" type="button" data-value="9" data-key="9">9</button>
        <button class="item operator green-yellow" type="button" data-value="+" data-i18n="add" data-i18n-attr-aria-label="add" data-key="+">+</button>
        <button id="btn-negate" class="item" type="button" data-i18n="plusMinus" data-i18n-attr-aria-label="plusMinus" data-key="n">+/−</button>
        <button class="item number" type="button" data-value="0" data-key="0">0</button>
        <button class="item dot" type="button" data-value="." data-i18n="decimal" data-i18n-attr-aria-label="decimal" data-key=".">.</button>
        <button class="item operator blue" type="button" data-value="=" data-i18n="equals" data-i18n-attr-aria-label="equals" data-key="enter">=</button>
    </section>
</main>

<section id="history" class="history-container" aria-label="تاریخچه محاسبات">
    <h2 data-i18n="historyTitle">تاریخچه</h2>
    <div id="history-items" class="history-items" data-i18n="historyArticle">
        هنوز موردی در تاریخچه نیست. وقتی آیتم‌هایی اضافه شد، اینجا می‌بینی‌شان.
    </div>
</section>

<!-- پاپ‌آپ نصب PWA -->
<div id="pwa-popup-overlay" class="pwa-overlay" hidden inert>
    <div class="pwa-modal" role="dialog" aria-modal="true" tabindex="-1"
         aria-labelledby="pwa-title" aria-describedby="pwa-desc">
        <button class="pwa-modal-close" type="button" aria-label="Close">&times;</button>

        <h2 id="pwa-title" data-i18n="pwaTitle" data-i18n-attr-aria-label="pwaTitle"></h2>
        <p id="pwa-desc" data-i18n="pwaDesc" data-i18n-attr-aria-label="pwaDesc"></p>

        <div class="pwa-modal-actions">
            <button id="pwa-btn-install" class="pwa-btn pwa-btn-primary" data-i18n="btnInstall" data-i18n-attr-aria-label="btnInstall"></button>
            <button id="pwa-btn-cancel" class="pwa-btn pwa-btn-secondary" data-i18n="btnCancel" data-i18n-attr-aria-label="btnCancel"></button>
        </div>

        <div class="pwa-modal-options">
            <label>
                <input type="checkbox" id="pwa-dont-show-again">
                <span data-i18n="dontShowAgain" data-i18n-attr-aria-label="dontShowAgain"></span>
            </label>
        </div>
    </div>
</div>

<script src="/assets/js/sw-register.js" defer></script>
<script type="module" src="/assets/js/main.js" defer></script>
<script src="/assets/js/pwa-install.js" defer></script>
</body>
</html>